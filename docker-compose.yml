services:
  clanker:
    build: .
    image: clanker:dev
    environment:
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      DISCORD_BOT_TOKEN: ${DISCORD_BOT_TOKEN}
      DISCORD_ALLOWED_USER_IDS: ${DISCORD_ALLOWED_USER_IDS}
      DISCORD_ALLOWED_CHANNEL_IDS: ${DISCORD_ALLOWED_CHANNEL_IDS}
      DISCORD_UNSAFE_ENABLE_WRITES: ${DISCORD_UNSAFE_ENABLE_WRITES}
      GH_DELEGATE_PROVIDER: ${GH_DELEGATE_PROVIDER}
      GH_TOKEN: ${GH_TOKEN}
      GH_WORKFLOW_ID: ${GH_WORKFLOW_ID}
      GH_REPO: ${GH_REPO}
      GH_REPOS: ${GH_REPOS}
      CLANKER_TRANSPORTS: discord
    volumes:
      - ./audit:/app/audit
    restart: unless-stopped
